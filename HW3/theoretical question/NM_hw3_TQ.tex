\documentclass[11pt, a4paper]{article}
\usepackage{amsmath, amssymb, titling}
\usepackage[margin=2.5cm]{geometry}
\usepackage[colorlinks=true, linkcolor=black, urlcolor=black, citecolor=black]{hyperref}
\usepackage{graphicx}
\usepackage{caption}
\usepackage{subcaption}
\usepackage{float}
\usepackage{cancel}
\usepackage{fancyhdr, lastpage}
\usepackage{fourier-orns}
\usepackage{xcolor}
\usepackage{nomencl}
\makenomenclature
\usepackage{etoolbox}
\usepackage{sidecap}
\usepackage{adjustbox}
\usepackage{listings}
\usepackage{matlab-prettifier}
\usepackage[T1]{fontenc}

\sidecaptionvpos{figure}{c}
\setlength{\headheight}{18.2pt}
\setlength{\nomlabelwidth}{1.5cm}

\renewcommand\maketitlehooka{\null\mbox{}\vfill}
\renewcommand\maketitlehookd{\vfill\null}

\renewcommand{\headrule}{\vspace{-5pt}\hrulefill\raisebox{-2.1pt}{\quad\leafleft\decoone\leafright\quad}\hrulefill}
\newcommand{\parder}[2]{\frac{\partial {#1}}{\partial {#2}}}
% \renewcommand\nomgroup[1]{%
%   \item[\bfseries
%   \ifstrequal{#1}{F}{Far--Away Properties}{%
%   \ifstrequal{#1}{N}{Dimensionless Numbers}{%
%   \ifstrequal{#1}{M}{Matrices}{%
%   \ifstrequal{#1}{D}{Diagonals}{%
%   \ifstrequal{#1}{V}{Vectors}{%
%   \ifstrequal{#1}{P}{Dimensionless Average Properties}{}}}}}}
% ]}

\title{Numerical Methods in Aeronautical Engineering \\ HW3 - Theoretical Questions}
\author{Almog Dobrescu ID 214254252}

% \pagestyle{fancy}
\cfoot{Page \thepage\ of \pageref{LastPage}}

\begin{document}

\maketitle
\thispagestyle{empty}
\newpage

\pagenumbering{roman}
% \setcounter{page}{1}

\tableofcontents
\newpage

\pagestyle{fancy}
\pagenumbering{arabic}
\setcounter{page}{1}

\section{Q2}
The differencing equation is given by:
\begin{equation}
    \begin{array}{rcl}
        \displaystyle \frac{u_{i,j+1}-u_{i,j}}{kG}+\mathcal{O}\left(\frac{k}{G}\right) & = & \displaystyle \alpha\frac{u_{i+1,j}-2u_{i,j}+u_{i-1,j}}{h^2}+\mathcal{O}\left(h^2\right) \\\\
        u_{i,j+1}-u_{i,j} & = & \displaystyle \frac{\alpha kG}{h^2}\left(u_{i+1,j}-2u_{i,j}+u_{i-1,j}\right)+\mathcal{O}\left(\frac{k}{G},h^2\right)
    \end{array}
\end{equation}
Where:
\begin{itemize}
    \item $h=\Delta x$
    \item $k=\Delta y$
    \item $C=\displaystyle\frac{\alpha k}{h^2}$
    \item $G=\displaystyle\frac{1}{2C}\left(1-e^{-2C}\right)=\displaystyle\frac{h^2}{2\alpha k}\left(1-e^{-2\frac{\alpha k}{h^2}}\right)$
\end{itemize}
Hence the truncation error is of the order of $\mathcal{O}\left(\frac{k}{G},h^2\right)$. \\

\noindent We will use von-Neumann Stability Analysis. Let's consider the error:
\begin{equation}
    e_{r,t}=T_{r,t}-\hat{T}_{r,t}
\end{equation}
\begin{itemize}
    \item $T_{r,t}$ - The solution of the differencing equation.
    \item $\hat{T}_{r,t}$ - The solution of the differencing equation with a small noise in the initial conditions.
\end{itemize}
\noindent Let's define:
\begin{equation}
    E_p=T_{p,0}-\hat{T}_{p,0}
\end{equation}
We can rewrite it as:
\begin{equation}
    E_p=\sum_{p=1}^{N}A_pe^{i\beta_n h p},\qquad i=\sqrt{-1},\qquad\beta_n=\frac{n\pi}{N+1}
\end{equation}
We want to check if there is a mode that diverges. Since the equation is linear we only need one mode to diverge to consider the hole scheme as diverged:
\begin{equation}
    E_p=A_pe^{i\beta_n h p}
\end{equation}
We need to check how the error behaves over time and to make sure it diminishes to $E_p$ when $t=0$.
Let's assume the error is of the form of:
\begin{equation}
    E_{p,j}=A_pe^{i\beta h p}\cdot e^{\alpha t_j}
\end{equation}
We are considered stable when $\Re{\left\{\alpha\right\}}<0$. \\
We can rewrite the error:
\begin{equation}
    E_{p,j}=A_pe^{i\beta h p}\cdot e^{\alpha\Delta tj}=A_pe^{i\beta h p}\cdot\xi^j
\end{equation}
Therefore the stability condition is $\left|\xi\right|\le1$
Since the differencing equation is linear we can demand the error to satisfy the differencing equation:
\begin{equation}
    E_{p,j+1}=\displaystyle E_{p,j}+\frac{\alpha kG}{h^2}\left(E_{p+1,j}-2E_{p,j}+E_{p-1,j}\right)
\end{equation}
After substituting the error we get:
\begin{equation}
    e^{i\beta h p}\cdot\xi^{j+1}=\displaystyle e^{i\beta h p}\cdot\xi^j+\frac{\alpha kG}{h^2}\left(e^{i\beta h \left(p+1\right)}\cdot\xi^j-2e^{i\beta h \left(p\right)}\cdot\xi^j+e^{i\beta h \left(p-1\right)}\cdot\xi^j\right)
\end{equation}
Dividing by $e^{i\beta h p}\xi^j$ we get:
\begin{equation}
    \xi=\displaystyle 1+\frac{\alpha kG}{h^2}\left(e^{i\beta h }-2+e^{-i\beta h }\right)
\end{equation}

\end{document}